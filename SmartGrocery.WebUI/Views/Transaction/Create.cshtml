@using SmartGrocery.WebUI.Models.Transactions

@model TransactionDetailsViewModel

@using (Html.BeginForm("Create", "Transaction", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
	<h3>Create Transaction</h3>
	<div class="section-container">
		@Html.HiddenFor(x => x.CreatedBy)
		@Html.HiddenFor(x => x.LastUpdatedBy)
		<div class="row">
			<div class="col-md-3 form-group required">
				@Html.LabelFor(x => x.TransactionNumber, new { @class = "form-label" })
				@Html.TextBoxFor(x => x.TransactionNumber, new { @class = "form-control" })
				@Html.ValidationMessageFor(x => x.TransactionNumber)
			</div>
			<div class="col-md-offset-1 col-md-3 form-group">
				@Html.LabelFor(x => x.CreatedAt, new { @class = "form-label" })
				<p>@Model.CreatedAt</p>
			</div>
		</div>
		
		<div class="row">
			<div class="col-md-3 form-group">
				@Html.LabelFor(x => x.CustomerId, new { @class = "form-label" })
				<div class="input-group">
					@Html.TextBoxFor(x => x.CustomerId, new { @class = "form-control" })
					<span class="input-group-addon clickable" id="search-customer-id">
						<i class="input-group glyphicon glyphicon-search"></i>
					</span>
				</div>
				@Html.ValidationMessageFor(x => x.CustomerId)
			</div>
			<div class="col-md-3 col-md-offset-1 form-group">
				@Html.LabelFor(x => x.CustomerName, new { @class="form-label" })
				@Html.TextBoxFor(x => x.CustomerName, new { @class="form-control" })
			</div>
			<div class="col-md-3 col-md-offset-1 form-group">
				@Html.LabelFor(x => x.CustomerEmotion, new { @class="form-label"})
				@Html.TextBoxFor(x => x.CustomerEmotion, new { @class="form-control", @readonly="readonly" })
			</div>
			@Html.HiddenFor(x => x.CustomerEmotionProbability)
		</div>
		
		<div class="row">
			<div class="col-md-3 form-group">
				@Html.LabelFor(x => x.Amount, new { @class="form-label" })
				<div class="input-group">
					@Html.TextBoxFor(x => x.Amount, new { @class="form-control", @readonly="readonly" })
					<span class="input-group-addon clickable" id="calculate-total-price">
						<i class="input-group glyphicon glyphicon-usd"></i>
					</span>
				</div>
				@Html.ValidationMessageFor(x => x.Amount)
			</div>
		</div>

		<div class="row">
			<div class="col-md-11 form-group">
				<table id="products-table" class="table table-hover table-bordered">
					<thead>
						<tr>
							<th class="col-sm-3">Product Number</th>
							<th class="col-sm-3">Product Name</th>
							<th class="col-md-2">Amount</th>
							<th class="col-md-2">Cost</th>
							<th class="col-md-1"></th>
						</tr>
					</thead>
					<tbody>
						@for (var i = 0; i < Model.ProductSnapshots.Length; i++)
						{
							@Html.EditorFor(m => m.ProductSnapshots[i], "_ProductSnapshot")
						}
					</tbody>
					<tfoot>
						<tr>
							<td colspan="5" style="text-align: left;">
								<input type="button" class="btn btn-sm btn-block " id="add-row" value="Add Row" />
							</td>
						</tr>
					</tfoot>
				</table>
			</div>
		</div>

		<div class="row">
			<div class="left">
				<div id="start" class="button">
					Start
				</div>
				<h2>Preview</h2>
				<video id="video" controls="controls" autoplay muted></video>
			</div>
			<div class="right">
				<div id="stopButton" class="button">
					Stop
				</div>
				<canvas id="canvas" hidden></canvas>
			</div>
			<div class="bottom">
				<pre id="log"></pre>
			</div>
		</div>
		<div class="row">
			<div class="progress">
				<div class="progress-bar progress-bar-danger progress-bar-striped active" style="width:100%; min-width:20px">
					Danger
				</div>
				@*<div class="progress-bar progress-bar-info progress-bar-striped active" style="width:10%; min-width:20px">
					Normal
				</div>
				<div class="progress-bar progress-bar-warning progress-bar-striped active" style="width:45%; min-width:20px">
					Good
				</div>*@
			</div>
		</div>
		<div class="row form-group">
			<button type="submit" class="btn btn-success">Confirm</button>
		</div>
	</div>
}

@section scripts{
	@Scripts.Render("~/bundles/transactions")
	<script src="@Url.Content("~/Scripts/jquery.webcam.js")">
	</script>
	<script>
		initilize();
	</script>
}